if (jQuery) 
    (function($){
        $.extend($.fn, {
            radiocheckBox: function(method, data){
                var init = function(input, data){
                    if (input.tagName.toLowerCase() !== 'input') 
                        return false;
                    
                    input = $(input);
                    if (input.data('radiocheckBox-control')) 
                        return false;
                    
                    var control = $('<span class="radiocheckBox"/>');
                    
                    control.addClass(input.attr('class')).attr('style', input.attr('style') || '').attr('title', input.attr('title') || '').attr('tabindex', parseInt(input.attr('tabindex'))).css('display', 'inline-block').bind('focus.radiocheckBox', function(){
                        if (this !== document.activeElement) 
                            $(document.activeElement).blur();
                        if (control.hasClass('radiocheckBox-active')) 
                            return;
                        control.addClass('radiocheckBox-active');
                        input.trigger('focus');
                    }).bind('blur.radiocheckBox', function(){
                        if (!control.hasClass('radiocheckBox-active')) 
                            return;
                        control.removeClass('radiocheckBox-active');
                        input.trigger('blur');
                    }).bind('mouseup.radiocheckBox', function(){
                        if (control.hasClass('radiocheckBox-disabled')) 
                            return;
                        setCheck(input, !input.attr('checked'));
                        input.trigger('change');
                    }).insertAfter(input);
                    
                    if (input.attr('disabled')) 
                        control.addClass('radiocheckBox-disabled');
                    
                    if (input.attr('type') == 'radio') {
                        control.addClass('radiocheckBox-radio');
                        input.data('radiocheckBox-radios', $('input[name="' + input.attr('name') + '"]').not(input));
                    }
                    input.addClass('radiocheckBox').data('radiocheckBox-control', control).hide();
                    setCheck(input, input.attr('checked'));
                }
                
                var setCheck = function(input, check){
                    input = $(input);
                    var control = input.data('radiocheckBox-control');
                    if (!control) 
                        return;
                    
                    if (check) {
                        input.attr('checked', 'checked');
                        control.addClass('radiocheckBox-checked')
                        if (radios = input.data('radiocheckBox-radios')) {
                            radios.radiocheckBox('check', false)
                        }
                    }
					// радиобаттон можно снять, и это круто!
                    else {
                        input.removeAttr('checked');
                        control.removeClass('radiocheckBox-checked')
                    }
                }
                
                var destroy = function(input){
                    input = $(input);
                    var control = input.data('radiocheckBox-control');
                    if (!control) 
                        return;
                    control.remove();
                    input.removeClass('radiocheckBox').removeData('radiocheckBox-control').removeData('radiocheckBox-radios').show();
                    
                };
                
                var enable = function(input){
                    input = $(input);
                    input.attr('disabled', false);
                    var control = input.data('radiocheckBox-control');
                    if (!control) 
                        return;
                    control.removeClass('radiocheckBox-disabled');
                };
                
                
                var disable = function(input){
                    input = $(input);
                    input.attr('disabled', true);
                    var control = input.data('radiocheckBox-control');
                    if (!control) 
                        return;
                    control.addClass('radiocheckBox-disabled');
                };
                
                switch (method) {
                    case 'control':
                        return $(this).data('radiocheckBox-control');
                        break;
                        
                    case 'check':
                        $(this).each(function(){
                            setCheck(this, data);
                        });
                        break;
                        
                    case 'enable':
                        $(this).each(function(){
                            enable(this);
                        });
                        break;
                        
                    case 'disable':
                        $(this).each(function(){
                            disable(this);
                        });
                        break;
                        
                    case 'destroy':
                        $(this).each(function(){
                            destroy(this);
                        });
                        break;
                        
                    default:
                        $(this).each(function(){
                            init(this, method);
                        });
                        break;
                        
                }
                
                return $(this);
            }
        });
    })(jQuery);
